{"ast":null,"code":"import NFTContractBuild from 'contracts/NFT.json';\nimport Web3 from 'web3';\nimport RequestContractBuild from 'contracts/RequestManager.json';\nlet selectedAccount;\nlet nftContract;\nlet erc20Contract;\nlet isInitialized = false;\nexport const init = async () => {\n  let provider = window.ethereum;\n\n  if (typeof provider !== 'undefined') {\n    provider.request({\n      method: 'eth_requestAccounts'\n    }).then(accounts => {\n      selectedAccount = accounts[0];\n      console.log(`Selected account is ${selectedAccount}`);\n    }).catch(err => {\n      console.log(err);\n      return;\n    });\n    window.ethereum.on('accountsChanged', function (accounts) {\n      selectedAccount = accounts[0];\n      console.log(`Selected account changed to ${selectedAccount}`);\n    });\n  }\n\n  const web3 = new Web3(provider);\n  const networkId = await web3.eth.net.getId(); // nftContract = new web3.eth.Contract(\n  // \tNFTContractBuild.abi,\n  // \tNFTContractBuild.networks[networkId].address\n  // );\n\n  const erc20Abi = [{\n    constant: true,\n    inputs: [{\n      name: '_owner',\n      type: 'address'\n    }],\n    name: 'balanceOf',\n    outputs: [{\n      name: 'balance',\n      type: 'uint256'\n    }],\n    payable: false,\n    stateMutability: 'view',\n    type: 'function'\n  }];\n  const requestabi = [{\n    \"inputs\": [{\n      \"internalType\": \"string\",\n      \"name\": \"_gameID\",\n      \"type\": \"string\"\n    }, {\n      \"internalType\": \"uint256\",\n      \"name\": \"_amount\",\n      \"type\": \"uint256\"\n    }],\n    \"name\": \"requestMint\",\n    \"outputs\": [],\n    \"stateMutability\": \"nonpayable\",\n    \"type\": \"function\"\n  }];\n  erc20Contract = new web3.eth.Contract(erc20Abi, // Dai contract on Rinkeby\n  '0x5592ec0cfb4dbc12d3ab100b257153436a1f0fea');\n  isInitialized = true;\n};\nexport const getOwnBalance = async () => {\n  if (!isInitialized) {\n    await init();\n  }\n\n  return erc20Contract.methods.balanceOf(selectedAccount).call().then(balance => {\n    return Web3.utils.fromWei(balance);\n  });\n};\nexport const mintToken = async () => {\n  if (!isInitialized) {\n    await init();\n  }\n\n  return nftContract.methods.mint(selectedAccount).send({\n    from: selectedAccount\n  });\n};\nexport const requestMint = async () => {\n  if (!isInitialized) {\n    await init();\n  }\n\n  return RequestContractBuild.methods.requestMint(\"aaa\", 10).send({\n    from: selectedAccount\n  });\n};","map":{"version":3,"names":["NFTContractBuild","Web3","RequestContractBuild","selectedAccount","nftContract","erc20Contract","isInitialized","init","provider","window","ethereum","request","method","then","accounts","console","log","catch","err","on","web3","networkId","eth","net","getId","erc20Abi","constant","inputs","name","type","outputs","payable","stateMutability","requestabi","Contract","getOwnBalance","methods","balanceOf","call","balance","utils","fromWei","mintToken","mint","send","from","requestMint"],"sources":["/Users/bagdongho/Desktop/web3-tutorials/WEB3-TUTORIAL/src/Web3Client.js"],"sourcesContent":["import NFTContractBuild from 'contracts/NFT.json';\nimport Web3 from 'web3';\nimport RequestContractBuild from 'contracts/RequestManager.json';\n\n\nlet selectedAccount;\n\nlet nftContract;\nlet erc20Contract;\n\nlet isInitialized = false;\n\nexport const init = async () => {\n\tlet provider = window.ethereum;\n\n\tif (typeof provider !== 'undefined') {\n\t\tprovider\n\t\t\t.request({ method: 'eth_requestAccounts' })\n\t\t\t.then((accounts) => {\n\t\t\t\tselectedAccount = accounts[0];\n\t\t\t\tconsole.log(`Selected account is ${selectedAccount}`);\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.log(err);\n\t\t\t\treturn;\n\t\t\t});\n\n\t\twindow.ethereum.on('accountsChanged', function (accounts) {\n\t\t\tselectedAccount = accounts[0];\n\t\t\tconsole.log(`Selected account changed to ${selectedAccount}`);\n\t\t});\n\t}\n\n\tconst web3 = new Web3(provider);\n\n\tconst networkId = await web3.eth.net.getId();\n\n\t// nftContract = new web3.eth.Contract(\n\t// \tNFTContractBuild.abi,\n\t// \tNFTContractBuild.networks[networkId].address\n\t// );\n\n\tconst erc20Abi = [\n\t\t{\n\t\t\tconstant: true,\n\t\t\tinputs: [\n\t\t\t\t{\n\t\t\t\t\tname: '_owner',\n\t\t\t\t\ttype: 'address'\n\t\t\t\t}\n\t\t\t],\n\t\t\tname: 'balanceOf',\n\t\t\toutputs: [\n\t\t\t\t{\n\t\t\t\t\tname: 'balance',\n\t\t\t\t\ttype: 'uint256'\n\t\t\t\t}\n\t\t\t],\n\t\t\tpayable: false,\n\t\t\tstateMutability: 'view',\n\t\t\ttype: 'function'\n\t\t}\n\t];\n\n\tconst requestabi = [{\n\t\t\"inputs\": [\n\t\t\t{\n\t\t\t\t\"internalType\": \"string\",\n\t\t\t\t\"name\": \"_gameID\",\n\t\t\t\t\"type\": \"string\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"internalType\": \"uint256\",\n\t\t\t\t\"name\": \"_amount\",\n\t\t\t\t\"type\": \"uint256\"\n\t\t\t}\n\t\t],\n\t\t\"name\": \"requestMint\",\n\t\t\"outputs\": [],\n\t\t\"stateMutability\": \"nonpayable\",\n\t\t\"type\": \"function\"\n\t}]\n\n\terc20Contract = new web3.eth.Contract(\n\t\terc20Abi,\n\t\t// Dai contract on Rinkeby\n\t\t'0x5592ec0cfb4dbc12d3ab100b257153436a1f0fea'\n\t);\n\n\tisInitialized = true;\n};\n\nexport const getOwnBalance = async () => {\n\tif (!isInitialized) {\n\t\tawait init();\n\t}\n\n\treturn erc20Contract.methods\n\t\t.balanceOf(selectedAccount)\n\t\t.call()\n\t\t.then((balance) => {\n\t\t\treturn Web3.utils.fromWei(balance);\n\t\t});\n};\n\nexport const mintToken = async () => {\n\tif (!isInitialized) {\n\t\tawait init();\n\t}\n\n\treturn nftContract.methods\n\t\t.mint(selectedAccount)\n\t\t.send({ from: selectedAccount });\n};\n\nexport const requestMint = async () => {\n\tif (!isInitialized) {\n\t\tawait init();\n\t}\n\n\treturn RequestContractBuild.methods\n\t\t.requestMint(\"aaa\", 10)\n\t\t.send({from: selectedAccount});\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}